{% block head %}
{% load i18n %}

{% comment %}
    This is the AJAX table sub-template that can be used to list virtual
    machines and clusters. 
    
    When rendering this template, you may optionally provide a `tableID` 
    argument and the table will encapsulate itself within the provided term, 
    for example:

    return render_to_response("virtual_machine/table.html",
            {'tableID': 'table_foo'},
            context_instance=RequestContext(request))

    This is handy if you're trying to render this sub-template more than once
    on the same page.
{% endcomment %}

<style>
    td.actions div.delete {
        float:none;
    }
    #content td.actions a, #content td.actions {
        padding:5px 0 0 0;
    }
    #vm-wrapper {
        margin-top: 20px;
        padding: 1px 0 0 0; /* Needed to make the table render correctly in Firefox */
    }
</style>

<script type="text/javascript">
    function sort(url, old_order, new_order) { 
        var order = getOrderAscDesc(old_order, new_order);
        location.href = url.replace(old_order, order);
    } 

    function getOrderAscDesc(old_order, new_order) {
        if (old_order == new_order) {
            return '-' + old_order;
        }
        else {
            return new_order;
        }
    }
</script>

{% endblock %}

{% if cluster %}
    <a class="button add" href="{% url instance-create cluster.slug %}">
        {% trans "Add Virtual Machine" %}
    </a>
{% else %}
    {% if can_create %}
    <a class="button add" href="{% url instance-create %}">
        {% trans "Add Virtual Machine" %}
    </a>
    {% endif %}
{% endif %}

<div id='ajaxTables'>
    <div id="vm-wrappers">
        {% include "ganeti/virtual_machine/inner_table.html" %}
    </div>
</div>

